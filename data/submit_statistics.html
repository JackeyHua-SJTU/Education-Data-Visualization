<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
	<script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script>
</head>
<body>
  <select id="select"></select>
  <div id="main" style="width: 600px;height:400px;"></div>
</body>
<script>
  var global_data = []
  fetch('http://127.0.0.1:5500/data/Data_TitleInfo.csv').then(res => res.text()).then(data => {
    let rows = data.split('\n')
    let select = document.getElementById('select')
    rows.forEach((item, index) => {
      let option = document.createElement('option')
      option.value = item.split(',')[1]
      option.innerText = item.split(',')[1]
      select.appendChild(option)
    })
    select.value = rows[1].split(',')[1]
    select.onchange = function() {
      renderChart(global_data[this.value])
    }
  })
  .then(fetch('http://127.0.0.1:5500/data/submit_statistics.json')
    .then(res => res.json())
    .then(data => {
      global_data = data;
      console.log(global_data)
      let question = document.getElementById('select').value
      renderChart(global_data[question])
    })
  );
  
  function renderChart(data) {
    let dates = Object.keys(data);
    let counts = Object.values(data);

    let myChart = echarts.init(document.getElementById('main'));
    let option = {
      title: {
        text: '提交统计'
      },
      tooltip: {},
      legend: {
        data: ['提交数']
      },
      xAxis: {
        data: dates
      },
      yAxis: {},
      series: [{
        name: '提交数',
        type: 'line',
        data: counts
      }]
    };
    myChart.setOption(option);
  }
</script>
</html>